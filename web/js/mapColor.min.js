var mapColor={};mapColor.map,mapColor.detail,mapColor.legend={},mapColor.legend.gradient,mapColor.legend.minValue,mapColor.legend.maxValue,mapColor.legend.label,mapColor.data={},mapColor.x=386,mapColor.y=295,mapColor.RootURL="/",mapColor.init=function(a,r){if(mapColor.map=Snap.select(a),"#France"!=a){var o=mapColor.map.getBBox();if(o.height>=o.width){var e=mapColor.x/2-o.cx,t=mapColor.y/2-o.cy,l=mapColor.x/o.height;mapColor.map.transform("t"+e+","+t+"s"+l)}else{var e=mapColor.x/2-o.cx,t=mapColor.y/2-o.cy,l=mapColor.y/o.width;mapColor.map.transform("t"+e+","+t+"s"+l)}}mapColor.detail=r,mapColor.legend.gradient=Snap.select("#Legend_gradient"),mapColor.legend.minValue=Snap.select("#Legend_minValue"),mapColor.legend.maxValue=Snap.select("#Legend_maxValue"),mapColor.legend.label=Snap.select("#Legend_label");for(var n=mapColor.map.selectAll("path"),m=0;m<n.length;++m)n[m].click(function(){var a="regions";switch(mapColor.detail){case"regions":a="departements";break;case"departements":a="arrondissements";break;case"arrondissements":a="communes"}window.location=mapColor.RootURL+"?r=map&map="+encodeURIComponent(this.attr("id"))+"&detail="+a}),n[m].hover(function(){var a=mapColor.data[this.attr("id")];this.attr({stroke:"#fff",strokeWidth:.3}),mapColor.legend.label.attr(null!=a?{text:this.attr("id")+" : "+a}:{text:this.attr("id")})},function(){this.attr({strokeWidth:0}),mapColor.legend.label.attr({text:"???"})})},mapColor.apply=function(a,r,o,e){function C(a,r,o){var t,l,i,d,C,e=(a-r)/(o-r);if(.5>=e){d=2*(.5-e),C=2*e;var t=s(n.r,m.r,d,C),l=s(n.g,m.g,d,C),i=s(n.b,m.b,d,C)}else{d=2*(1-e),C=2*(e-.5);var t=s(m.r,p.r,d,C),l=s(m.g,p.g,d,C),i=s(m.b,p.b,d,C)}return"rgb("+t+","+l+","+i+")"}function s(a,r,o,e){var t=a*o+r*e;return Math.floor(t)}mapColor.data=a;var t=Number.MAX_VALUE,l=Number.MIN_VALUE,n=tinycolor(r).toRgb(),m=tinycolor(o).toRgb(),p=tinycolor(e).toRgb();for(var i in a)t>a[i]&&(t=a[i]),l<a[i]&&(l=a[i]);mapColor.legend.minValue.attr({text:t}),mapColor.legend.maxValue.attr({text:l});for(var i in a){var d;(d=mapColor.map.select("#"+i))&&d.attr({fill:C(a[i],t,l)})}mapColor.legend.gradient.attr({fill:"l(0,0,1,0)"+r+"-"+o+"-"+e})};